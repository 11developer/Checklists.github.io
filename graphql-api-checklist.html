<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WillJTools GraphQL API Checklist</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>WillJTools GraphQL API Penetration Testing Checklist</h1>
    </header>
    <main>
        <article>
            <h2>Checklist</h2>
            <ul>
                <li><input type="checkbox" id="schema-discovery"> <label for="schema-discovery"><strong>Schema Discovery and Analysis:</strong> Utilize introspection to discover and analyze available queries, mutations, and types. (Tools: InQL Scanner, GraphQL Voyager; Example command: <code>{ __schema { types { name, fields { name, type { name } } } }}</code> to gather comprehensive schema information)</label></li>
                <li><input type="checkbox" id="introspection-testing"> <label for="introspection-testing"><strong>Testing for Introspection:</strong> Ensure introspection queries are disabled in production to protect schema details. (Tools: Burp Suite, custom scripts; Example command: Attempt introspection with <code>{__schema{types{name}}}</code> and ensure it returns an error in production environments.)</label></li>
                <li><input type="checkbox" id="auth-testing"> <label for="auth-testing"><strong>Authentication and Authorization Testing:</strong> Verify security mechanisms to ensure only authorized access to resources. (Tools: Burp Suite, OWASP ZAP; Example command: Attempt to fetch sensitive data without authentication or with an expired token to test access controls.)</label></li>
                <li><input type="checkbox" id="batch-query-testing"> <label for="batch-query-testing"><strong>Batch Query Testing:</strong> Test for potential denial of service (DoS) through batched queries and deeply nested queries. (Tools: Custom scripts, GraphQL Fuzzer; Example command: <code>{ user(id:"1"){ friends { friends { friends { id } } } } }</code> to test server response to deep nesting)</label></li>
                <li><input type="checkbox" id="query-depth-limit"> <label for="query-depth-limit"><strong>Query Depth Limit:</strong> Verify that depth limiting is in place to prevent overly complex queries from overloading the server. (Tools: Burp Suite, custom middleware; Example setup: Configure depth limiting in GraphQL server settings and attempt to exceed this limit to test enforcement.)</label></li>
                <li><input type="checkbox" id="field-suggestion"> <label for="field-suggestion"><strong>Field Suggestion Testing:</strong> Ensure that automatic field suggestions are disabled to prevent information leakage. (Tools: Manual testing, Burp Suite; Example test: Access the API with a graphical IDE like GraphiQL to see if sensitive fields are suggested.)</label></li>
                <li><input type="checkbox" id="alias-overloading"> <label for="alias-overloading"><strong>Alias Overloading:</strong> Check for abuse of aliases to perform unauthorized actions or to bypass security controls. (Tools: Burp Suite, GraphQLmap; Example command: <code>{ user(id: "1") { id, username } newUser: user(id: "2") { id, username } }</code> to test how aliases are handled.)</label></li>
                <li><input type="checkbox" id="mutation-testing"> <label for="mutation-testing"><strong>Mutation Testing:</strong> Test mutation operations for security issues, ensuring they properly check permissions before executing changes. (Tools: Burp Suite, OWASP ZAP; Example command: <code>mutation { updatePassword(id: "1", newPass: "123456") { success } }</code> to check if unauthorized password changes are allowed.)</label></li>
                <li><input type="checkbox" id="error-handling"> <label for="error-handling"><strong>Error Handling:</strong> Analyze error messages to ensure they do not disclose sensitive information about the GraphQL schema or underlying systems. (Tools: Manual testing, Burp Suite; Example test: Force errors in queries and observe error messages for hints about backend details or schema structure.)</label></li>
                <li><input type="checkbox" id="rate-limiting"> <label for="rate-limiting"><strong>Rate Limiting:</strong> Evaluate the implementation of rate limiting to mitigate abuse scenarios. (Tools: Burp Suite Intruder, custom rate limit testers; Example command: Execute a script that makes repeated requests to a GraphQL endpoint to test if and when rate limiting kicks in.)</label></li>
                <li><input type="checkbox" id="subscription-security"> <label for="subscription-security"><strong>Subscription Security:</strong> Verify the security of subscription operations, ensuring they are restricted to authorized users only. (Tools: Manual testing, custom scripts; Example test: Attempt to access subscription data streams without proper credentials.)</label></li>
                <li><input type="checkbox" id="input-validation"> <label for="input-validation"><strong>Input Validation:</strong> Test for common vulnerabilities like SQL injection, XSS through inputs in GraphQL queries. (Tools: GraphQLmap, Burp Suite; Example command: Include malicious payloads in query variables to test sanitization, e.g., <code>{ user(id: "1' OR '1'='1") { name } }</code>)</label></li>
                <li><input type="checkbox" id="cost-analysis"> <label for="cost-analysis"><strong>Query Cost Analysis:</strong> Perform cost analysis on queries to ensure they don't lead to resource exhaustion. (Tools: Apollo Engine, custom scripts; Example command: Analyze the cost of complex queries to ensure they are within acceptable limits, adjust settings if necessary.)</label></li>
                <li><input type="checkbox" id="compliance-checks"> <label for="compliance-checks"><strong>Compliance Checks:</strong> Ensure that GraphQL operations comply with regulatory requirements such as GDPR. (Tools: Manual review, compliance software; Example command: Review all data handling practices in GraphQL queries to ensure compliance with data protection regulations.)</label></li>
                <li><input type="checkbox" id="documentation-review"> <label for="documentation-review"><strong>Documentation Review:</strong> Review documentation for accuracy and unintentional exposure of sensitive details. (Tools: Manual review; Example command: Cross-reference published schema details with documentation to ensure no additional information is leaked.)</label></li>
                <li><input type="checkbox" id="third-party-libraries"> <label for="third-party-libraries"><strong>Third-Party Libraries:</strong> Examine all third-party libraries for known vulnerabilities. (Tools: OWASP Dependency Check, Retire.js; Example command: Run <code>dependency-check</code> against the server environment to detect outdated or vulnerable libraries.)</label></li>
                <li><input type="checkbox" id="direct-object-references"> <label for="direct-object-references"><strong>Direct Object Reference Tests:</strong> Test for unauthorized access to objects via direct references. (Tools: Burp Suite, custom scripts; Example command: Change IDs in queries to test for unauthorized data access, e.g., <code>{ user(id: "5") { name } }</code> where '5' is not authorized.)</label></li>
                <li><input type="checkbox" id="logging-mechanisms"> <label for="logging-mechanisms"><strong>Logging Mechanisms:</strong> Ensure that all actions, especially mutations, are logged correctly to trace malicious activities. (Tools: ELK Stack, custom logging solutions; Example setup: Configure GraphQL server to log all query and mutation requests along with user context.)</label></li>
                <li><input type="checkbox" id="response-timing-analysis"> <label for="response-timing-analysis"><strong>Response Timing Analysis:</strong> Analyze response times to infer backend processing and to identify potential vulnerabilities like timing attacks. (Tools: Custom timing analysis scripts, Burp Suite; Example command: Measure response times for different query loads to detect discrepancies that may indicate backend processing issues.)</label></li>
                <li><input type="checkbox" id="stateful-inspection"> <label for="stateful-inspection"><strong>Stateful Inspection of Sessions:</strong> Check how the API handles session state, particularly in authentication and re-authentication scenarios. (Tools: Burp Suite, custom scripts; Example command: Test session tokens before and after re-authentication to ensure tokens are refreshed or invalidated as necessary.)</label></li>
                <li><input type="checkbox" id="api-gateway-integration"> <label for="api-gateway-integration"><strong>API Gateway Integration:</strong> Test integration with API gateways to ensure that security policies are correctly enforced. (Tools: AWS API Gateway, Azure API Management; Example setup: Configure rate limiting and authentication at the gateway level and test for enforcement.)</label></li>
                <li><input type="checkbox" id="dynamic-query-analysis"> <label for="dynamic-query-analysis"><strong>Dynamic Query Analysis:</strong> Examine how the API handles dynamically constructed queries and prevent potential injection or abuse. (Tools: Custom scripts, Burp Suite; Example command: Construct queries dynamically on the client-side and monitor for improper handling or execution.)</label></li>
                <li><input type="checkbox" id="mutation-side-effects"> <label for="mutation-side-effects"><strong>Mutation Side-Effects:</strong> Test mutations for unintended side effects that could impact data integrity or user experience. (Tools: Burp Suite, custom test suites; Example command: Perform a mutation and verify all related entities to ensure only intended changes are made.)</label></li>
                <li><input type="checkbox" id="query-whitelisting"> <label for="query-whitelisting"><strong>Query Whitelisting:</strong> Implement and test a whitelisting approach where only pre-approved queries are allowed. (Tools: GraphQL Shield, custom middleware; Example setup: Define a list of allowed queries and block all others at runtime.)</label></li>
                <li><input type="checkbox" id="schema-change-management"> <label for="schema-change-management"><strong>Schema Change Management:</strong> Monitor and audit changes to the GraphQL schema to prevent unauthorized alterations. (Tools: Schema change detection tools, version control systems; Example command: Set up alerts for any commits to schema files in version control.)</label></li>
                <li><input type="checkbox" id="deprecation-strategy"> <label for="deprecation-strategy"><strong>Deprecation Strategy:</strong> Test how deprecated queries and fields are handled to ensure they don't introduce security vulnerabilities. (Tools: Manual testing, GraphQL IDE tools; Example command: Mark certain fields as deprecated in the schema and verify they are no longer accessible or visible in production.)</label></li>
            </ul>
        </article>
    </main>
    <footer>
        <p Copyright 2024 WillJTools</p>
    </footer>
</body>
</html>
